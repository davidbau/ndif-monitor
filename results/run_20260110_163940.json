{
  "timestamp": "2026-01-10T16:39:40.422308Z",
  "nnsight_version": "0.5.14",
  "duration_seconds": 380.6,
  "summary": {
    "ok": 7,
    "slow": 0,
    "degraded": 0,
    "failed": 5,
    "unavailable": 0,
    "total": 12
  },
  "tests": [
    {
      "model": "meta-llama/Llama-2-7b-hf",
      "scenario": "basic_trace",
      "status": "OK",
      "duration_ms": 21906,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:41:37.602051Z"
    },
    {
      "model": "meta-llama/Llama-2-7b-hf",
      "scenario": "generation",
      "status": "OK",
      "duration_ms": 20838,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:41:58.444442Z"
    },
    {
      "model": "meta-llama/Llama-2-7b-hf",
      "scenario": "hidden_states",
      "status": "FAILED",
      "duration_ms": 20374,
      "error_category": "SHAPE_MISMATCH",
      "details": "[NbConvertApp] Converting notebook /Users/davidbau/git/ndif-monitor/notebooks/test_hidden_states.ipynb to notebook\nTraceback (most recent call last):\n  File \"/opt/homebrew/Caskroom/miniforge/base/bin/jupyter-nbconvert\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/application.py\", line 284, in launch_instance\n    super().launch_instance(argv=argv, **kwargs)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 420, in start\n    self.convert_notebooks()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 597, in convert_notebooks\n    self.convert_single_notebook(notebook_filename)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 563, in convert_single_notebook\n    output, resources = self.export_single_notebook(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 487, in export_single_notebook\n    output, resources = self.exporter.from_filename(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 201, in from_filename\n    return self.from_file(f, resources=resources, **kw)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 220, in from_file\n    return self.from_notebook_node(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/notebook.py\", line 36, in from_notebook_node\n    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 154, in from_notebook_node\n    nb_copy, resources = self._preprocess(nb_copy, resources)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 353, in _preprocess\n    nbc, resc = preprocessor(nbc, resc)\n                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/base.py\", line 48, in __call__\n    return self.preprocess(nb, resources)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 103, in preprocess\n    self.preprocess_cell(cell, resources, index)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 124, in preprocess_cell\n    cell = self.execute_cell(cell, index, store_history=True)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/utils/__init__.py\", line 165, in wrapped\n    return loop.run_until_complete(inner)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 1062, in async_execute_cell\n    await self._check_raise_for_error(cell, cell_index, exec_reply)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 918, in _check_raise_for_error\n    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)\nnbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:\n------------------\n# Validate all hidden states\nimport torch\n\nprint(f\"\\nValidating {len(hidden_states)} layer outputs...\")\n\nfor i, hidden in enumerate(hidden_states):\n    # Check shape\n    assert len(hidden.shape) >= 2, f\"Layer {i}: Expected at least 2D tensor\"\n    \n    # Check for NaN/Inf\n    assert not torch.isnan(hidden).any(), f\"Layer {i}: Contains NaN\"\n    assert not torch.isinf(hidden).any(), f\"Layer {i}: Contains Inf\"\n    \n    # Check reasonable values\n    max_val = hidden.abs().max().item()\n    assert max_val < 10000, f\"Layer {i}: Values too large ({max_val})\"\n    \n    if i == 0 or i == n_layers - 1 or i == n_layers // 2:\n        print(f\"  Layer {i}: shape={hidden.shape}, max={max_val:.2f}\")\n\n# Check shapes are consistent\nshapes = [h.shape for h in hidden_states]\nhidden_dim = shapes[0][-1]\nfor i, shape in enumerate(shapes):\n    assert shape[-1] == hidden_dim, f\"Layer {i}: Inconsistent hidden dim\"\n\nprint(f\"\\nAll {n_layers} layers validated!\")\nprint(f\"Hidden dimension: {hidden_dim}\")\n\nprint(\"\\n\" + \"=\" * 40)\nprint(\"HIDDEN STATES \" + \"TEST PASSED\")\nprint(\"=\" * 40)\n------------------\n\n\n\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mNameError\u001b[39m                                 Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[6]\u001b[39m\u001b[32m, line 4\u001b[39m\n\u001b[32m      1\u001b[39m \u001b[38;5;66;03m# Validate all hidden states\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mtorch\u001b[39;00m\n\u001b[32m----> \u001b[39m\u001b[32m4\u001b[39m \u001b[38;5;28mprint\u001b[39m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mValidating \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlen\u001b[39m(\u001b[43mhidden_states\u001b[49m)\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m layer outputs...\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m      6\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i, hidden \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28menumerate\u001b[39m(hidden_states):\n\u001b[32m      7\u001b[39m     \u001b[38;5;66;03m# Check shape\u001b[39;00m\n\u001b[32m      8\u001b[39m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(hidden.shape) >= \u001b[32m2\u001b[39m, \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mLayer \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mi\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m: Expected at least 2D tensor\u001b[39m\u001b[33m\"\u001b[39m\n\n\u001b[31mNameError\u001b[39m: name 'hidden_states' is not defined\n\n",
      "timestamp": "2026-01-10T16:42:18.823757Z"
    },
    {
      "model": "EleutherAI/gpt-j-6b",
      "scenario": "basic_trace",
      "status": "OK",
      "duration_ms": 21564,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:42:40.393384Z"
    },
    {
      "model": "EleutherAI/gpt-j-6b",
      "scenario": "generation",
      "status": "OK",
      "duration_ms": 23327,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:43:03.726183Z"
    },
    {
      "model": "EleutherAI/gpt-j-6b",
      "scenario": "hidden_states",
      "status": "FAILED",
      "duration_ms": 23930,
      "error_category": "SHAPE_MISMATCH",
      "details": "[NbConvertApp] Converting notebook /Users/davidbau/git/ndif-monitor/notebooks/test_hidden_states.ipynb to notebook\nTraceback (most recent call last):\n  File \"/opt/homebrew/Caskroom/miniforge/base/bin/jupyter-nbconvert\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/application.py\", line 284, in launch_instance\n    super().launch_instance(argv=argv, **kwargs)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 420, in start\n    self.convert_notebooks()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 597, in convert_notebooks\n    self.convert_single_notebook(notebook_filename)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 563, in convert_single_notebook\n    output, resources = self.export_single_notebook(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 487, in export_single_notebook\n    output, resources = self.exporter.from_filename(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 201, in from_filename\n    return self.from_file(f, resources=resources, **kw)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 220, in from_file\n    return self.from_notebook_node(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/notebook.py\", line 36, in from_notebook_node\n    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 154, in from_notebook_node\n    nb_copy, resources = self._preprocess(nb_copy, resources)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 353, in _preprocess\n    nbc, resc = preprocessor(nbc, resc)\n                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/base.py\", line 48, in __call__\n    return self.preprocess(nb, resources)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 103, in preprocess\n    self.preprocess_cell(cell, resources, index)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 124, in preprocess_cell\n    cell = self.execute_cell(cell, index, store_history=True)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/utils/__init__.py\", line 165, in wrapped\n    return loop.run_until_complete(inner)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 1062, in async_execute_cell\n    await self._check_raise_for_error(cell, cell_index, exec_reply)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 918, in _check_raise_for_error\n    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)\nnbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:\n------------------\n# Validate all hidden states\nimport torch\n\nprint(f\"\\nValidating {len(hidden_states)} layer outputs...\")\n\nfor i, hidden in enumerate(hidden_states):\n    # Check shape\n    assert len(hidden.shape) >= 2, f\"Layer {i}: Expected at least 2D tensor\"\n    \n    # Check for NaN/Inf\n    assert not torch.isnan(hidden).any(), f\"Layer {i}: Contains NaN\"\n    assert not torch.isinf(hidden).any(), f\"Layer {i}: Contains Inf\"\n    \n    # Check reasonable values\n    max_val = hidden.abs().max().item()\n    assert max_val < 10000, f\"Layer {i}: Values too large ({max_val})\"\n    \n    if i == 0 or i == n_layers - 1 or i == n_layers // 2:\n        print(f\"  Layer {i}: shape={hidden.shape}, max={max_val:.2f}\")\n\n# Check shapes are consistent\nshapes = [h.shape for h in hidden_states]\nhidden_dim = shapes[0][-1]\nfor i, shape in enumerate(shapes):\n    assert shape[-1] == hidden_dim, f\"Layer {i}: Inconsistent hidden dim\"\n\nprint(f\"\\nAll {n_layers} layers validated!\")\nprint(f\"Hidden dimension: {hidden_dim}\")\n\nprint(\"\\n\" + \"=\" * 40)\nprint(\"HIDDEN STATES \" + \"TEST PASSED\")\nprint(\"=\" * 40)\n------------------\n\n\n\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mNameError\u001b[39m                                 Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[6]\u001b[39m\u001b[32m, line 4\u001b[39m\n\u001b[32m      1\u001b[39m \u001b[38;5;66;03m# Validate all hidden states\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mtorch\u001b[39;00m\n\u001b[32m----> \u001b[39m\u001b[32m4\u001b[39m \u001b[38;5;28mprint\u001b[39m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mValidating \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlen\u001b[39m(\u001b[43mhidden_states\u001b[49m)\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m layer outputs...\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m      6\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i, hidden \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28menumerate\u001b[39m(hidden_states):\n\u001b[32m      7\u001b[39m     \u001b[38;5;66;03m# Check shape\u001b[39;00m\n\u001b[32m      8\u001b[39m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(hidden.shape) >= \u001b[32m2\u001b[39m, \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mLayer \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mi\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m: Expected at least 2D tensor\u001b[39m\u001b[33m\"\u001b[39m\n\n\u001b[31mNameError\u001b[39m: name 'hidden_states' is not defined\n\n",
      "timestamp": "2026-01-10T16:43:27.662591Z"
    },
    {
      "model": "allenai/Olmo-3-1025-7B",
      "scenario": "basic_trace",
      "status": "FAILED",
      "duration_ms": 24442,
      "error_category": "SERIALIZATION_ERROR",
      "details": "[NbConvertApp] Converting notebook /Users/davidbau/git/ndif-monitor/notebooks/test_basic_trace.ipynb to notebook\nTraceback (most recent call last):\n  File \"/opt/homebrew/Caskroom/miniforge/base/bin/jupyter-nbconvert\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/application.py\", line 284, in launch_instance\n    super().launch_instance(argv=argv, **kwargs)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 420, in start\n    self.convert_notebooks()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 597, in convert_notebooks\n    self.convert_single_notebook(notebook_filename)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 563, in convert_single_notebook\n    output, resources = self.export_single_notebook(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 487, in export_single_notebook\n    output, resources = self.exporter.from_filename(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 201, in from_filename\n    return self.from_file(f, resources=resources, **kw)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 220, in from_file\n    return self.from_notebook_node(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/notebook.py\", line 36, in from_notebook_node\n    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 154, in from_notebook_node\n    nb_copy, resources = self._preprocess(nb_copy, resources)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 353, in _preprocess\n    nbc, resc = preprocessor(nbc, resc)\n                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/base.py\", line 48, in __call__\n    return self.preprocess(nb, resources)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 103, in preprocess\n    self.preprocess_cell(cell, resources, index)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 124, in preprocess_cell\n    cell = self.execute_cell(cell, index, store_history=True)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/utils/__init__.py\", line 165, in wrapped\n    return loop.run_until_complete(inner)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 1062, in async_execute_cell\n    await self._check_raise_for_error(cell, cell_index, exec_reply)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 918, in _check_raise_for_error\n    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)\nnbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:\n------------------\n# Run basic trace - use model name to select correct layer path\n# NOTE: Variables from outside model.trace() are NOT available on the server!\n# We must use separate trace blocks per architecture.\n\nprompt = \"The quick brown fox\"\nprint(f\"Running trace on: '{prompt}'\")\n\n# Detect architecture from model name\nmodel_lower = MODEL_NAME.lower()\n\nstart = time.time()\nif 'gpt-j' in model_lower or 'gpt2' in model_lower:\n    # GPT-2, GPT-J: transformer.h\n    with model.trace(prompt, remote=True):\n        hidden = model.transformer.h[0].output[0].save()\nelif 'gpt-neo' in model_lower or 'pythia' in model_lower:\n    # GPT-NeoX, Pythia: gpt_neox.layers\n    with model.trace(prompt, remote=True):\n        hidden = model.gpt_neox.layers[0].output[0].save()\nelif 'olmo' in model_lower:\n    # OLMo: model.transformer.blocks\n    with model.trace(prompt, remote=True):\n        hidden = model.model.transformer.blocks[0].output[0].save()\nelse:\n    # Llama, Mistral, Qwen, etc.: model.layers\n    with model.trace(prompt, remote=True):\n        hidden = model.model.layers[0].output[0].save()\n\ntrace_time = time.time() - start\nprint(f\"Trace completed in {trace_time:.1f}s\")\n------------------\n\n----- stdout -----\nRunning trace on: 'The quick brown fox'\n------------------\n\n\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mExitTracingException\u001b[39m                      Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[4]\u001b[39m\u001b[32m, line 23\u001b[39m\n\u001b[32m     22\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m model.trace(prompt, remote=\u001b[38;5;28;01mTrue\u001b[39;00m):\n\u001b[32m---> \u001b[39m\u001b[32m23\u001b[39m         hidden = \u001b[43mmodel\u001b[49m.model.transformer.blocks[\u001b[32m0\u001b[39m].output[\u001b[32m0\u001b[39m].save()\n\u001b[32m     24\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m     25\u001b[39m     \u001b[38;5;66;03m# Llama, Mistral, Qwen, etc.: model.layers\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/tracing/base.py:621\u001b[39m, in \u001b[36mTracer.__enter__.<locals>.skip_traced_code\u001b[39m\u001b[34m(frame, event, arg)\u001b[39m\n\u001b[32m    620\u001b[39m \u001b[38;5;66;03m# Raise exception to exit normal execution flow\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m621\u001b[39m \u001b[38;5;28;01mraise\u001b[39;00m ExitTracingException()\n\n\u001b[31mExitTracingException\u001b[39m: \n\nDuring handling of the above exception, another exception occurred:\n\n\u001b[31mRemoteException\u001b[39m                           Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[4]\u001b[39m\u001b[32m, line 22\u001b[39m\n\u001b[32m     19\u001b[39m         hidden = model.gpt_neox.layers[\u001b[32m0\u001b[39m].output[\u001b[32m0\u001b[39m].save()\n\u001b[32m     20\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m \u001b[33m'\u001b[39m\u001b[33molmo\u001b[39m\u001b[33m'\u001b[39m \u001b[38;5;129;01min\u001b[39;00m model_lower:\n\u001b[32m     21\u001b[39m     \u001b[38;5;66;03m# OLMo: model.transformer.blocks\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m22\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m model.trace(prompt, remote=\u001b[38;5;28;01mTrue\u001b[39;00m):\n\u001b[32m     23\u001b[39m         hidden = model.model.transformer.blocks[\u001b[32m0\u001b[39m].output[\u001b[32m0\u001b[39m].save()\n\u001b[32m     24\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m     25\u001b[39m     \u001b[38;5;66;03m# Llama, Mistral, Qwen, etc.: model.layers\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/tracing/base.py:665\u001b[39m, in \u001b[36mTracer.__exit__\u001b[39m\u001b[34m(self, exc_type, exc_val, exc_tb)\u001b[39m\n\u001b[32m    662\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.asynchronous:\n\u001b[32m    663\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.backend(\u001b[38;5;28mself\u001b[39m)\n\u001b[32m--> \u001b[39m\u001b[32m665\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mbackend\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m    667\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;01mTrue\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:349\u001b[39m, in \u001b[36mRemoteBackend.__call__\u001b[39m\u001b[34m(self, tracer)\u001b[39m\n\u001b[32m    344\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.async_request(tracer)\n\u001b[32m    346\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.blocking:\n\u001b[32m    347\u001b[39m \n\u001b[32m    348\u001b[39m     \u001b[38;5;66;03m# Do blocking request.\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m349\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mblocking_request\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtracer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    351\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    352\u001b[39m \n\u001b[32m    353\u001b[39m     \u001b[38;5;66;03m# Otherwise we are getting the status / result of the existing job.\u001b[39;00m\n\u001b[32m    354\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.non_blocking_request(tracer)\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:598\u001b[39m, in \u001b[36mRemoteBackend.blocking_request\u001b[39m\u001b[34m(self, tracer)\u001b[39m\n\u001b[32m    594\u001b[39m             \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[32m    596\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[32m--> \u001b[39m\u001b[32m598\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m e\n\u001b[32m    600\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m    601\u001b[39m     LocalTracer.deregister()\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:582\u001b[39m, in \u001b[36mRemoteBackend.blocking_request\u001b[39m\u001b[34m(self, tracer)\u001b[39m\n\u001b[32m    580\u001b[39m response = ResponseModel.unpickle(response)\n\u001b[32m    581\u001b[39m \u001b[38;5;66;03m# Handle the response.\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m582\u001b[39m result = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mhandle_response\u001b[49m\u001b[43m(\u001b[49m\u001b[43mresponse\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtracer\u001b[49m\u001b[43m=\u001b[49m\u001b[43mtracer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    583\u001b[39m \u001b[38;5;66;03m# Break when completed.\u001b[39;00m\n\u001b[32m    584\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m    585\u001b[39m \n\u001b[32m    586\u001b[39m     \u001b[38;5;66;03m# If the response has no result data, it was too big and we need to stream it from the server.\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:382\u001b[39m, in \u001b[36mRemoteBackend.handle_response\u001b[39m\u001b[34m(self, response, tracer)\u001b[39m\n\u001b[32m    378\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m response.status == ResponseModel.JobStatus.ERROR:\n\u001b[32m    379\u001b[39m     \u001b[38;5;28mself\u001b[39m.status_display.update(\n\u001b[32m    380\u001b[39m         response.id, response.status.name, response.description \u001b[38;5;129;01mor\u001b[39;00m \u001b[33m\"\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    381\u001b[39m     )\n\u001b[32m--> \u001b[39m\u001b[32m382\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m RemoteException(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mresponse.description\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mRemote exception.\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m    384\u001b[39m \u001b[38;5;66;03m# Log response for user (skip STREAM status - it's internal)\u001b[39;00m\n\u001b[32m    385\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m response.status != ResponseModel.JobStatus.STREAM:\n\n\u001b[31mRemoteException\u001b[39m: Traceback (most recent call last):\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/deployments/modeling/base.py\", line 210, in __call__\n    result = await job_task\n             ^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/miniconda3/envs/service/lib/python3.12/asyncio/threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/miniconda3/envs/service/lib/python3.12/concurrent/futures/thread.py\", line 59, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/miniconda3/envs/service/lib/python3.12/site-packages/ray/util/tracing/tracing_helper.py\", line 461, in _resume_span\n    return method(self, *_args, **_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/deployments/modeling/base.py\", line 274, in execute\n    result = RemoteExecutionBackend(\n             ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/backend.py\", line 24, in __call__\n    run(tracer, self.fn)\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/sandbox.py\", line 16, in run\n    raise wrap_exception(e, tracer.info) from None\nnnsight.NNsightException: \n\nTraceback (most recent call last):\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/sandbox.py\", line 6, in run\n    hidden = model.model.transformer.blocks[0].output[0].save()\n\nAttributeError: Olmo3Model(\n  (embed_tokens): Embedding(100278, 4096, padding_idx=100277)\n  (layers): ModuleList(\n    (0-31): 32 x Olmo3DecoderLayer(\n      (self_attn): Olmo3Attention(\n        (q_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (k_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (v_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (o_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (q_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n        (k_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n      )\n      (mlp): Olmo3MLP(\n        (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (up_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (down_proj): Linear(in_features=11008, out_features=4096, bias=False)\n        (act_fn): SiLUActivation()\n      )\n      (post_attention_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n      (post_feedforward_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n    )\n  )\n  (norm): Olmo3RMSNorm((4096,), eps=1e-06)\n  (rotary_embs): ModuleDict(\n    (sliding_attention): Olmo3RotaryEmbedding()\n    (full_attention): Olmo3RotaryEmbedding()\n  )\n) has no attribute transformer\n\n\n\nTraceback (most recent call last):\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/sandbox.py\", line 6, in run\n    hidden = model.model.transformer.blocks[0].output[0].save()\n\nAttributeError: Olmo3Model(\n  (embed_tokens): Embedding(100278, 4096, padding_idx=100277)\n  (layers): ModuleList(\n    (0-31): 32 x Olmo3DecoderLayer(\n      (self_attn): Olmo3Attention(\n        (q_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (k_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (v_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (o_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (q_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n        (k_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n      )\n      (mlp): Olmo3MLP(\n        (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (up_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (down_proj): Linear(in_features=11008, out_features=4096, bias=False)\n        (act_fn): SiLUActivation()\n      )\n      (post_attention_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n      (post_feedforward_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n    )\n  )\n  (norm): Olmo3RMSNorm((4096,), eps=1e-06)\n  (rotary_embs): ModuleDict(\n    (sliding_attention): Olmo3RotaryEmbedding()\n    (full_attention): Olmo3RotaryEmbedding()\n  )\n) has no attribute transformer\nRemote exception.\n\n",
      "timestamp": "2026-01-10T16:43:52.110549Z"
    },
    {
      "model": "allenai/Olmo-3-1025-7B",
      "scenario": "generation",
      "status": "OK",
      "duration_ms": 25989,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:44:18.104250Z"
    },
    {
      "model": "allenai/Olmo-3-1025-7B",
      "scenario": "hidden_states",
      "status": "FAILED",
      "duration_ms": 27135,
      "error_category": "SERIALIZATION_ERROR",
      "details": "[NbConvertApp] Converting notebook /Users/davidbau/git/ndif-monitor/notebooks/test_hidden_states.ipynb to notebook\nTraceback (most recent call last):\n  File \"/opt/homebrew/Caskroom/miniforge/base/bin/jupyter-nbconvert\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/application.py\", line 284, in launch_instance\n    super().launch_instance(argv=argv, **kwargs)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 420, in start\n    self.convert_notebooks()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 597, in convert_notebooks\n    self.convert_single_notebook(notebook_filename)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 563, in convert_single_notebook\n    output, resources = self.export_single_notebook(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 487, in export_single_notebook\n    output, resources = self.exporter.from_filename(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 201, in from_filename\n    return self.from_file(f, resources=resources, **kw)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 220, in from_file\n    return self.from_notebook_node(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/notebook.py\", line 36, in from_notebook_node\n    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 154, in from_notebook_node\n    nb_copy, resources = self._preprocess(nb_copy, resources)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 353, in _preprocess\n    nbc, resc = preprocessor(nbc, resc)\n                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/base.py\", line 48, in __call__\n    return self.preprocess(nb, resources)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 103, in preprocess\n    self.preprocess_cell(cell, resources, index)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 124, in preprocess_cell\n    cell = self.execute_cell(cell, index, store_history=True)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/utils/__init__.py\", line 165, in wrapped\n    return loop.run_until_complete(inner)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 1062, in async_execute_cell\n    await self._check_raise_for_error(cell, cell_index, exec_reply)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 918, in _check_raise_for_error\n    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)\nnbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:\n------------------\n# Extract hidden states from all layers\n# NOTE: Variables from outside model.trace() are NOT available on the server!\n# We must use separate trace blocks per architecture with hardcoded layer paths.\n\nprompt = \"Hello world\"\nprint(f\"Running trace on: '{prompt}'\")\nprint(f\"Extracting hidden states from {n_layers} layers...\")\n\n# Detect architecture from model name\nmodel_lower = MODEL_NAME.lower()\n\nstart = time.time()\nif 'gpt-j' in model_lower or 'gpt2' in model_lower:\n    # GPT-2, GPT-J: transformer.h\n    with model.trace(prompt, remote=True):\n        hidden_states = [model.transformer.h[i].output[0].save() for i in range(n_layers)]\nelif 'gpt-neo' in model_lower or 'pythia' in model_lower:\n    # GPT-NeoX, Pythia: gpt_neox.layers\n    with model.trace(prompt, remote=True):\n        hidden_states = [model.gpt_neox.layers[i].output[0].save() for i in range(n_layers)]\nelif 'olmo' in model_lower:\n    # OLMo: model.transformer.blocks\n    with model.trace(prompt, remote=True):\n        hidden_states = [model.model.transformer.blocks[i].output[0].save() for i in range(n_layers)]\nelse:\n    # Llama, Mistral, Qwen, etc.: model.layers\n    with model.trace(prompt, remote=True):\n        hidden_states = [model.model.layers[i].output[0].save() for i in range(n_layers)]\n\ntrace_time = time.time() - start\nprint(f\"Extraction completed in {trace_time:.1f}s\")\n------------------\n\n----- stdout -----\nRunning trace on: 'Hello world'\nExtracting hidden states from 32 layers...\n------------------\n\n\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mExitTracingException\u001b[39m                      Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[5]\u001b[39m\u001b[32m, line 24\u001b[39m\n\u001b[32m     23\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m model.trace(prompt, remote=\u001b[38;5;28;01mTrue\u001b[39;00m):\n\u001b[32m---> \u001b[39m\u001b[32m24\u001b[39m         hidden_states = [model.model.transformer.blocks[i].output[\u001b[32m0\u001b[39m].save() \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(n_layers)]\n\u001b[32m     25\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m     26\u001b[39m     \u001b[38;5;66;03m# Llama, Mistral, Qwen, etc.: model.layers\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/tracing/base.py:621\u001b[39m, in \u001b[36mTracer.__enter__.<locals>.skip_traced_code\u001b[39m\u001b[34m(frame, event, arg)\u001b[39m\n\u001b[32m    620\u001b[39m \u001b[38;5;66;03m# Raise exception to exit normal execution flow\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m621\u001b[39m \u001b[38;5;28;01mraise\u001b[39;00m ExitTracingException()\n\n\u001b[31mExitTracingException\u001b[39m: \n\nDuring handling of the above exception, another exception occurred:\n\n\u001b[31mRemoteException\u001b[39m                           Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[5]\u001b[39m\u001b[32m, line 23\u001b[39m\n\u001b[32m     20\u001b[39m         hidden_states = [model.gpt_neox.layers[i].output[\u001b[32m0\u001b[39m].save() \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(n_layers)]\n\u001b[32m     21\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m \u001b[33m'\u001b[39m\u001b[33molmo\u001b[39m\u001b[33m'\u001b[39m \u001b[38;5;129;01min\u001b[39;00m model_lower:\n\u001b[32m     22\u001b[39m     \u001b[38;5;66;03m# OLMo: model.transformer.blocks\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m23\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m model.trace(prompt, remote=\u001b[38;5;28;01mTrue\u001b[39;00m):\n\u001b[32m     24\u001b[39m         hidden_states = [model.model.transformer.blocks[i].output[\u001b[32m0\u001b[39m].save() \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(n_layers)]\n\u001b[32m     25\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m     26\u001b[39m     \u001b[38;5;66;03m# Llama, Mistral, Qwen, etc.: model.layers\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/tracing/base.py:665\u001b[39m, in \u001b[36mTracer.__exit__\u001b[39m\u001b[34m(self, exc_type, exc_val, exc_tb)\u001b[39m\n\u001b[32m    662\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.asynchronous:\n\u001b[32m    663\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.backend(\u001b[38;5;28mself\u001b[39m)\n\u001b[32m--> \u001b[39m\u001b[32m665\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mbackend\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m    667\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;01mTrue\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:349\u001b[39m, in \u001b[36mRemoteBackend.__call__\u001b[39m\u001b[34m(self, tracer)\u001b[39m\n\u001b[32m    344\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.async_request(tracer)\n\u001b[32m    346\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.blocking:\n\u001b[32m    347\u001b[39m \n\u001b[32m    348\u001b[39m     \u001b[38;5;66;03m# Do blocking request.\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m349\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mblocking_request\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtracer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    351\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    352\u001b[39m \n\u001b[32m    353\u001b[39m     \u001b[38;5;66;03m# Otherwise we are getting the status / result of the existing job.\u001b[39;00m\n\u001b[32m    354\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.non_blocking_request(tracer)\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:598\u001b[39m, in \u001b[36mRemoteBackend.blocking_request\u001b[39m\u001b[34m(self, tracer)\u001b[39m\n\u001b[32m    594\u001b[39m             \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[32m    596\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[32m--> \u001b[39m\u001b[32m598\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m e\n\u001b[32m    600\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m    601\u001b[39m     LocalTracer.deregister()\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:582\u001b[39m, in \u001b[36mRemoteBackend.blocking_request\u001b[39m\u001b[34m(self, tracer)\u001b[39m\n\u001b[32m    580\u001b[39m response = ResponseModel.unpickle(response)\n\u001b[32m    581\u001b[39m \u001b[38;5;66;03m# Handle the response.\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m582\u001b[39m result = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mhandle_response\u001b[49m\u001b[43m(\u001b[49m\u001b[43mresponse\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtracer\u001b[49m\u001b[43m=\u001b[49m\u001b[43mtracer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    583\u001b[39m \u001b[38;5;66;03m# Break when completed.\u001b[39;00m\n\u001b[32m    584\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m    585\u001b[39m \n\u001b[32m    586\u001b[39m     \u001b[38;5;66;03m# If the response has no result data, it was too big and we need to stream it from the server.\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nnsight/intervention/backends/remote.py:382\u001b[39m, in \u001b[36mRemoteBackend.handle_response\u001b[39m\u001b[34m(self, response, tracer)\u001b[39m\n\u001b[32m    378\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m response.status == ResponseModel.JobStatus.ERROR:\n\u001b[32m    379\u001b[39m     \u001b[38;5;28mself\u001b[39m.status_display.update(\n\u001b[32m    380\u001b[39m         response.id, response.status.name, response.description \u001b[38;5;129;01mor\u001b[39;00m \u001b[33m\"\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    381\u001b[39m     )\n\u001b[32m--> \u001b[39m\u001b[32m382\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m RemoteException(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mresponse.description\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mRemote exception.\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m    384\u001b[39m \u001b[38;5;66;03m# Log response for user (skip STREAM status - it's internal)\u001b[39;00m\n\u001b[32m    385\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m response.status != ResponseModel.JobStatus.STREAM:\n\n\u001b[31mRemoteException\u001b[39m: Traceback (most recent call last):\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/deployments/modeling/base.py\", line 210, in __call__\n    result = await job_task\n             ^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/miniconda3/envs/service/lib/python3.12/asyncio/threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/miniconda3/envs/service/lib/python3.12/concurrent/futures/thread.py\", line 59, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/miniconda3/envs/service/lib/python3.12/site-packages/ray/util/tracing/tracing_helper.py\", line 461, in _resume_span\n    return method(self, *_args, **_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/deployments/modeling/base.py\", line 274, in execute\n    result = RemoteExecutionBackend(\n             ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/backend.py\", line 24, in __call__\n    run(tracer, self.fn)\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/sandbox.py\", line 16, in run\n    raise wrap_exception(e, tracer.info) from None\nnnsight.NNsightException: \n\nTraceback (most recent call last):\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/sandbox.py\", line 6, in run\n    hidden_states = [model.model.transformer.blocks[i].output[0].save() for i in range(n_layers)]\n\nAttributeError: Olmo3Model(\n  (embed_tokens): Embedding(100278, 4096, padding_idx=100277)\n  (layers): ModuleList(\n    (0-31): 32 x Olmo3DecoderLayer(\n      (self_attn): Olmo3Attention(\n        (q_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (k_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (v_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (o_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (q_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n        (k_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n      )\n      (mlp): Olmo3MLP(\n        (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (up_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (down_proj): Linear(in_features=11008, out_features=4096, bias=False)\n        (act_fn): SiLUActivation()\n      )\n      (post_attention_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n      (post_feedforward_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n    )\n  )\n  (norm): Olmo3RMSNorm((4096,), eps=1e-06)\n  (rotary_embs): ModuleDict(\n    (sliding_attention): Olmo3RotaryEmbedding()\n    (full_attention): Olmo3RotaryEmbedding()\n  )\n) has no attribute transformer\n\n\n\nTraceback (most recent call last):\n  File \"/u/svcndifuser/ndif-deployment/repos/prod/ndif/src/services/ray/src/ray/nn/sandbox.py\", line 6, in run\n    hidden_states = [model.model.transformer.blocks[i].output[0].save() for i in range(n_layers)]\n\nAttributeError: Olmo3Model(\n  (embed_tokens): Embedding(100278, 4096, padding_idx=100277)\n  (layers): ModuleList(\n    (0-31): 32 x Olmo3DecoderLayer(\n      (self_attn): Olmo3Attention(\n        (q_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (k_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (v_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (o_proj): Linear(in_features=4096, out_features=4096, bias=False)\n        (q_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n        (k_norm): Olmo3RMSNorm((4096,), eps=1e-06)\n      )\n      (mlp): Olmo3MLP(\n        (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (up_proj): Linear(in_features=4096, out_features=11008, bias=False)\n        (down_proj): Linear(in_features=11008, out_features=4096, bias=False)\n        (act_fn): SiLUActivation()\n      )\n      (post_attention_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n      (post_feedforward_layernorm): Olmo3RMSNorm((4096,), eps=1e-06)\n    )\n  )\n  (norm): Olmo3RMSNorm((4096,), eps=1e-06)\n  (rotary_embs): ModuleDict(\n    (sliding_attention): Olmo3RotaryEmbedding()\n    (full_attention): Olmo3RotaryEmbedding()\n  )\n) has no attribute transformer\nRemote exception.\n\n",
      "timestamp": "2026-01-10T16:44:45.244490Z"
    },
    {
      "model": "openai-community/gpt2",
      "scenario": "basic_trace",
      "status": "OK",
      "duration_ms": 23038,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:45:08.286158Z"
    },
    {
      "model": "openai-community/gpt2",
      "scenario": "generation",
      "status": "OK",
      "duration_ms": 24307,
      "error_category": null,
      "details": null,
      "timestamp": "2026-01-10T16:45:32.598242Z"
    },
    {
      "model": "openai-community/gpt2",
      "scenario": "hidden_states",
      "status": "FAILED",
      "duration_ms": 20908,
      "error_category": "SHAPE_MISMATCH",
      "details": "[NbConvertApp] Converting notebook /Users/davidbau/git/ndif-monitor/notebooks/test_hidden_states.ipynb to notebook\nTraceback (most recent call last):\n  File \"/opt/homebrew/Caskroom/miniforge/base/bin/jupyter-nbconvert\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/application.py\", line 284, in launch_instance\n    super().launch_instance(argv=argv, **kwargs)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 420, in start\n    self.convert_notebooks()\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 597, in convert_notebooks\n    self.convert_single_notebook(notebook_filename)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 563, in convert_single_notebook\n    output, resources = self.export_single_notebook(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/nbconvertapp.py\", line 487, in export_single_notebook\n    output, resources = self.exporter.from_filename(\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 201, in from_filename\n    return self.from_file(f, resources=resources, **kw)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 220, in from_file\n    return self.from_notebook_node(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/notebook.py\", line 36, in from_notebook_node\n    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 154, in from_notebook_node\n    nb_copy, resources = self._preprocess(nb_copy, resources)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/exporters/exporter.py\", line 353, in _preprocess\n    nbc, resc = preprocessor(nbc, resc)\n                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/base.py\", line 48, in __call__\n    return self.preprocess(nb, resources)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 103, in preprocess\n    self.preprocess_cell(cell, resources, index)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py\", line 124, in preprocess_cell\n    cell = self.execute_cell(cell, index, store_history=True)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jupyter_core/utils/__init__.py\", line 165, in wrapped\n    return loop.run_until_complete(inner)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 1062, in async_execute_cell\n    await self._check_raise_for_error(cell, cell_index, exec_reply)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/nbclient/client.py\", line 918, in _check_raise_for_error\n    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)\nnbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:\n------------------\n# Validate all hidden states\nimport torch\n\nprint(f\"\\nValidating {len(hidden_states)} layer outputs...\")\n\nfor i, hidden in enumerate(hidden_states):\n    # Check shape\n    assert len(hidden.shape) >= 2, f\"Layer {i}: Expected at least 2D tensor\"\n    \n    # Check for NaN/Inf\n    assert not torch.isnan(hidden).any(), f\"Layer {i}: Contains NaN\"\n    assert not torch.isinf(hidden).any(), f\"Layer {i}: Contains Inf\"\n    \n    # Check reasonable values\n    max_val = hidden.abs().max().item()\n    assert max_val < 10000, f\"Layer {i}: Values too large ({max_val})\"\n    \n    if i == 0 or i == n_layers - 1 or i == n_layers // 2:\n        print(f\"  Layer {i}: shape={hidden.shape}, max={max_val:.2f}\")\n\n# Check shapes are consistent\nshapes = [h.shape for h in hidden_states]\nhidden_dim = shapes[0][-1]\nfor i, shape in enumerate(shapes):\n    assert shape[-1] == hidden_dim, f\"Layer {i}: Inconsistent hidden dim\"\n\nprint(f\"\\nAll {n_layers} layers validated!\")\nprint(f\"Hidden dimension: {hidden_dim}\")\n\nprint(\"\\n\" + \"=\" * 40)\nprint(\"HIDDEN STATES \" + \"TEST PASSED\")\nprint(\"=\" * 40)\n------------------\n\n\n\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mNameError\u001b[39m                                 Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[6]\u001b[39m\u001b[32m, line 4\u001b[39m\n\u001b[32m      1\u001b[39m \u001b[38;5;66;03m# Validate all hidden states\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mtorch\u001b[39;00m\n\u001b[32m----> \u001b[39m\u001b[32m4\u001b[39m \u001b[38;5;28mprint\u001b[39m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mValidating \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlen\u001b[39m(\u001b[43mhidden_states\u001b[49m)\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m layer outputs...\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m      6\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i, hidden \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28menumerate\u001b[39m(hidden_states):\n\u001b[32m      7\u001b[39m     \u001b[38;5;66;03m# Check shape\u001b[39;00m\n\u001b[32m      8\u001b[39m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(hidden.shape) >= \u001b[32m2\u001b[39m, \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mLayer \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mi\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m: Expected at least 2D tensor\u001b[39m\u001b[33m\"\u001b[39m\n\n\u001b[31mNameError\u001b[39m: name 'hidden_states' is not defined\n\n",
      "timestamp": "2026-01-10T16:45:53.510887Z"
    }
  ]
}